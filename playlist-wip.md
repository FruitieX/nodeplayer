# Nodeplayer playlist concepts
## Definitions
### Playlist

- Generic list of songs that can be added to the playback queue.
- Core contains playlist management functionality for:
    - Creating playlists
    - Adding/removing songs to/from playlists
    - Editing playlists
    - Listing playlists
- Backends can provide playlists, containing songs from that backend.
    - These will start out as read-only to keep things simple.
- Plugins can provide autogenerated playlists, for example based on ratings.
    - These are also read-only by the user, plugin can modify.

### Playback queue

- Contains list of songs that the player will play / has played.
- Keeps track of where playback currently is.
- Keeps track of which playlist a song was added from (if any). This is simply
  a field in the song object containing the name and backend of the playlist.
    - This makes it possible for clients to display songs differently depending
      on which playlist they were added from.
    - One time use, 'pseudo-playlists', are also possible. nodeplayer blindly
      trusts which playlist a song was added from, the client can decide.
    - Pseudo-playlists can be used by clients to implement functionality such
      as queuing songs before the rest of the playback queue. This simulates
      something like the WinAmp queue, which is always played before the rest
      of the playback queue. Let's call this the 'pre-queue'.
        - This is done by having the client reserve a certain playlist name
          for the pre-queue, say '__prequeue'.
        - The client checks the current playback queue at the current playback
          position.
            - If the current song was added from a playlist '__prequeue', find
              the first song after it that is not part of __prequeue, insert
              song before it.
            - If the current song is not part of __prequeue, insert song into
              the playback queue immediately after the current song and mark it
              as __prequeue.
    - Implementing pre-queue functionality like this makes playlist handling
      code much much simpler. E.g. song preparing doesn't need to care about
      a separate queue and playlist, it only needs to know about the one and
      only playback queue.
    - Plugins can restrict how the playback queue is managed, e.g. partyplay
      only allows appending into __prequeue.
